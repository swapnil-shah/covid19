extends ../layouts/dashboard.pug

block config
    - var bodyClass = 'nav-fixed'
    - var pageTitle = 'COVID19 Dahboard'
    - var pageIcon = 'filter'
    - var pageSummary = 'An extended version of the DataTables library, customized for COVID19 Pro'
    - var sidenavStyle = 'sidenav-light'
    - var pageHeaderStyle = 'page-header-dark'
    - var pageHeaderBackground = 'bg-gradient-primary-to-secondary'
    - var footerStyle = 'footer-light'

append css
    link(href='https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css', rel='stylesheet', crossorigin='anonymous')
    script(src='https://www.gstatic.com/charts/loader.js', type="text/javascript")
    style(type='text/css').
           circle {
                stroke-width:0px;
            }
    script(type="text/javascript").
        let chartWorldData = [];

        // Fetch World Data
        fetch("https://corona-api.com/countries", { cache: 'no-cache' }).then((response) => response.json()).then((countries) => {
            countries.data.forEach((country) => {
                chartWorldData.push([
                    country.coordinates.latitude,
                    country.coordinates.longitude,
                    country.name,
                    country.latest_data.confirmed
                ]);
            });
            console.log(chartWorldData)
        });
        google.charts.load('current', {
            packages: [ 'geochart' ]
        });
        google.charts.setOnLoadCallback(drawMap);
        // World Map
        function drawMap() {
            var dataWorld = new google.visualization.DataTable();
            dataWorld.addColumn('number', 'Lat'); // Latitude Value
            dataWorld.addColumn('number', 'Lon'); // Longitude Value
            dataWorld.addColumn('string', 'Name'); //
            dataWorld.addColumn('number', 'Total Cases'); //
            dataWorld.addRows(chartWorldData);
            var optionsWorld = {
                theme: 'maximized',
                legend:'none',
                backgroundColor: { fill: '#202327', stroke: '#202327', strokeWidth:2},
                datalessRegionColor: '#3B3B3B',
                sizeAxis: { minValue: 100 },
                displayMode: 'markers',
                markerOpacity:0.8,
                colorAxis: { colors: [ '#FF8726', '#FF8726' ] },
                animation: {
                    duration: 1000,
                    easing: 'out'
                }
            };
            optionsWorld['backgroundColor.stroke'] = "#ffffff"
            var chartWorld = new google.visualization.GeoChart(document.getElementById('covidWorldChart'));
            chartWorld.draw(dataWorld, optionsWorld);
        }
    

block content
    .page-header#chart-container
        #covidWorldChart
    h1.geo-chart-title-wrapper
        span.geo-chart-title.text-center
            | COVID19 WORLD SPREAD DATA
            br
            span Tap/click on the marker for more information

    .container-fluid.mt-n5.mb-5(style="z-index: 1050;")
        .card.mb-2
            .card-body        
                .row.justify-content-md-center
                    .col-sm-12
                        h1 Worldwide
                    .col-md-3.col-sm-6.mb-3
                        .card.bg-secondary.border-0
                            .card-body
                                h3.text-white-75 Confirmed
                                    i.text-white-50.float-right.fas.fa-lg.fa-lungs-virus
                                .mb-4
                                    #number-confirmed.display-4.text-white
                                    #per-confirmed.text-white-75.float-right Loading numbers..
                    .col-md-3.col-sm-6.mb-3
                        .card.bg-dark.border-0
                            .card-body
                                h3.text-white-75 Active
                                    i.text-white-50.float-right.fas.fa-lg.fa-hospital-symbol
                                .mb-4
                                    #number-active.display-4.text-white
                                    #per-active.text-white-75.float-right Loading numbers..
                    .col-md-3.col-sm-6.mb-3
                        .card.bg-success.border-0
                            .card-body
                                h3.text-white-75 Recovered
                                    i.text-white-50.float-right.fas.fa-lg.fa-house-user
                                .mb-4
                                    #number-recovered.display-4.text-white
                                    #per-recovered.text-white-75.float-right Loading numbers..
                    .col-md-3.col-sm-6.mb-3
                        .card.bg-danger.border-0
                            .card-body
                                h3.text-white-75 Deaths
                                    i.text-white-50.float-right.fas.fa-lg.fa-bed
                                .mb-4
                                    #number-deaths.display-4.text-white
                                    #per-deaths.text-white-75.float-right Loading numbers..
                    .col-sm-12(style="padding:0")
                        #last-updated
                        .chart-line.border-top
                            canvas#myDashboardChart.table
                        .card#card-legend
                            .card-body(style="padding:0.5rem")
                                .row
                                    .col.text-center
                                        p.font-italic.font-weight-300.text-left.mb-1
                                            small Select a region
                                        .select(style="width:20rem")
                                            select#selectRegion
                                                option(value="worldwide" selected) Worldwide
                                .row#legend-numbers.d-none.justify-content-around.pb-1.pt-1.text-center.border-bottom
                                    .col(style="padding:0.5rem")
                                        p.mb-1
                                            small.font-weight-light.mb-1 Confirmed
                                        p#legend-confirmed.card-text.text-dark
                                    .col(style="padding:0.5rem")
                                        p.mb-1
                                            small.font-weight-light.mb-1 Recovered
                                        p#legend-recovered.card-text.text-dark
                                    .col(style="padding:0.5rem")
                                        p.mb-1
                                            small.font-weight-light.mb-1 Deaths
                                        p#legend-deaths.card-text.text-dark
                                p.card-text.float-right.mt-1
                                    small.text-muted#last-updated-legend.font-weight-light
        .card.mb-4
            .card-header Extended DataTables
            .card-body
                .row.justify-content-between
                    .col-md-8.col-sm-12
                        h6.mb-2.text-muted.lead The cases gets updated in approximately 24hours
                    .col-md-4.col-sm-12.pb-2.text-right
                        p.mb-1
                            small
                                strong New Cases: 
                                span.ge-2-lt-5.bg-yellow-200
                                | &ge; 2% and &lt; 5%
                                span.ge-5-lt-8.bg-yellow-500.ml-2
                                | &ge; 5% and &lt; 8
                                span.ge-8.bg-yellow-900.ml-2
                                | &ge; 8%
                        p.mb-1
                            small 
                                strong New Deaths: 
                                span.ge-2-lt-5.bg-red-200
                                | &ge; 2% and &lt; 5%
                                span.ge-5-lt-8.bg-red-500.ml-2
                                | &ge; 5% and &lt; 8
                                span.ge-8.bg-red-900.ml-2
                                | &ge; 8%
                        p.mb-1
                            small 
                                strong New Recovered: 
                                span.ge-2-lt-5.bg-green-200
                                | &ge; 2% and &lt; 5%
                                span.ge-5-lt-8.bg-green-500.ml-2
                                | &ge; 5% and &lt; 8
                                span.ge-8.bg-green-900.ml-2
                                | &ge; 8%
                                
                include includes/datatables/datatable-dashboard.pug

append scripts
    //- script(src='https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js', crossorigin='anonymous')
    //- script(src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js', crossorigin='anonymous')
    //- script(src='https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js', crossorigin='anonymous')
    //- script(src='js/dashboard.js')
